---
layout: math
title: "Programming Tips: ビット演算"
date: 2024-04-14
use_math: true
---

# 導入

##  論理演算

0 と 1 のいずれかの値を取る変数、すなわち１ビットの変数 x, y に対し、
演算 $$ \lnot x $$, $$ x \land y $$, $$ x \lor y $$, $$ x \oplus y $$ を
否定 (not) 、論理積 (and) 、論理和 (or) 、排他的論理和 (xor) と呼び、
以下のように定義される。

###   否定 (not)

| $$x$$ | $$ \lnot x $$|
|------:|:-------------|
|     0 | 1 |
|     1 | 0 |

###   論理積 (and)

| $$x$$ | $$y$$ | $$ x \land y $$ |
|------:|------:|:----------------|
|    0  |     0 | 0 |
|    0  |     1 | 0 |
|    1  |     0 | 0 |
|    1  |     1 | 1 |

###   論理和 (or)

| $$x$$ | $$y$$ | $$ x \lor y $$ |
|------:|------:|:----------------|
|    0  |     0 | 0 |
|    0  |     1 | 1 |
|    1  |     0 | 1 |
|    1  |     1 | 1 |

###   排他的論理和 (exclusive or - xor)

| $$x$$ | $$y$$ | $$ x \oplus y $$ |
|------:|------:|:----------------|
|    0  |     0 | 0 |
|    0  |     1 | 1 |
|    1  |     0 | 1 |
|    1  |     1 | 0 |

##  ビット演算 (Bitwise Operators)

- n ビットの変数 x, y に対し、各ビット毎 (bit-wise) に
  上記の論理演算を適用すること。
- C 言語および多くの言語では、それぞれ ~, &, \|, ^ 演算子が該当する。

以下に例を示す

###   bitwise not

|    |  二進数  | 16進数 | 10進数 |
|---:|---------:|-------:|-------:|
|  x | 00001111 |  0x0f  |    15  |
| ~x | 11110000 |  0xf0  |   240  |

###   bitwise and

|       |  二進数  | 16進数 | 10進数 |
|------:|---------:|-------:|-------:|
|     x | 01010101 |  0x55  |    85  |
|     y | 00001111 |  0x0f  |    15  |
| x & y | 00000101 |  0x05  |     5  |

この演算では、x and 0 = 0, x and 1 = x になることから、
ビット列中の特定のビットだけ注目したい時に役立つ。

この例では、00001111 と and を取っているので、
x の下位４ビットである 0101 がそのまま抽出され
上位４ビットはすべて 0 になる。このような操作をマスクとも呼ぶ。

###   bitwise or

|       |  二進数  | 16進数 | 10進数 |
|------:|---------:|-------:|-------:|
|     x | 01010101 |  0x55  |    85  |
|     y | 00001111 |  0x07  |     7  |
| x & y | 01011111 |  0x5f  |    95  |

この演算では、x or 0 = x, x or 1 = 1 になることから、
特定のビットを 1 にし、その他のビットは変化させない、
という処理を行うことができる。

この例では、上位４ビットは 0101 のまま変化せず、
下位４ビットを 1111 に変化させた。

###   bitwise xor

|       |  二進数  | 16進数 | 10進数 |
|------:|---------:|-------:|-------:|
|     x | 01010101 |  0x55  |    85  |
|     y | 00001111 |  0x07  |     7  |
| x ^ y | 01011010 |  0x5a  |    90  |

この演算では、y で指定したビットパターンに基づいて、
x のビットを反転させることができる。
y = 00001111 なので、
x の上位４ビットはそのまま変化させず、
下位４ビットだけ 0と1 を反転させる、という操作になる。

#  基本編

#  おまけ

#  応用編
